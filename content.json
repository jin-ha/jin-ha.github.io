{"pages":[],"posts":[{"title":"Github page 블로그 시작 (hexo icarus 설정)","text":"예전부터 미뤄왔던 블로그를 이제서야 시작해본다.첫글은 hexo icarus 테마 중 내가 몇가지 수정한 것을 포스팅 한글 font 변경 profile 변경 article 가독성을 위해 변경 그 외에도 몇가지 (방문자수 등) introhexo 관련 구글링을 하다보면 거의 모든 hexo 블로그의 시작 포스팅은 이 hexo 설정글이다.hexo 설치나 기본 포스팅 방법들은 구글링하면 잘 정리해둔 블로그들이 엄청 많으니 생략하고,나도 그 설정글 작성에 동참을 해보기 위해 몇가지 내가 수정한 사항들만 포스팅해본다. 수정한 내용 중 틀린부분이 있을 수 있습니다.혹시 틀린부분이나 더 정확한 수정방법이 있으면 댓글 남겨주세요. icarus 설정icarus 릴리즈노트를 보면 3.0 대로 버전이 올라가면서 레이아웃이 JSX과 Inferno.js으로 모두 변경되었다고 한다.icarus 설정글 구글링시 대부분 기존 html 템플릿 엔진인 ejs를 기준으로 작성된 블로그가 대부분이다..프론트엔드쪽을 많이 본적은 없지만 jsx 문법은 꽤나 직관적인것 같다. 아직은 몇가지 스타일만 변경하였는데 jsx도 조금씩 수정해봐야겠다. 이 글은 icarus 3.0.0 버전을 기준으로 작성합니다. 한글 font 변경icarus 기본 한글 글씨체도 나쁘지 않았지만, 나눔스퀘어라운드 폰트를 사용하기로 했다. 폰트 cdn import아래 cdn 주소를 import 해준다. themes/icarus/source/css/default.styl1@import url(https://cdn.rawgit.com/innks/NanumSquareRound/master/nanumsquareround.css) 폰트 지정기존 $family-sans-serif 라인을 주석처리 한뒤, 아래처럼 지정한다. themes/icarus/include/style/base.styl12// $family-sans-serif ?= Ubuntu, Roboto, 'Open Sans', 'Microsoft YaHei', sans-serif$family-sans-serif ?= 'NanumSquareRound', \"Helvetica Neue\", sans-serif profile 변경기존 profile 위젯의 하단은 무조건 follow 라는 github 링크 버튼이 따라다니는데, 뭔가 테마에 맞지 않는 파란색으로 느껴졌다. 그리고 포스팅 내용을 본 뒤 home으로 가는 버튼이 있으면 좋을것 같아 해당 위치의 버튼을 home 버튼기능으로 변경하고, 디자인도 변경하였다. icarus 테마는 Bulma라는 CSS 프레임웍을 사용한다.https://bulma.io/documentation/elements/button/#styles 에서 다양한 버튼이 확인 가능하다. themes/icarus/layout/widget/profile.jsx을 보면 기존 followLink 코드를 볼 수 있다. themes/icarus/layout/widget/profile.jsx123{followLink ? &lt;div class=\"level\"&gt;&lt;a class=\"level-item button is-primary is-rounded\" href={followLink} target=\"_blank\" rel=\"noopener\"&gt;{followTitle}&lt;/a&gt;&lt;/div&gt; : null} github follow 기능을 유지하고 버튼 스타일만 변경할 경우 위 코드의 class 부분을 bulma 링크에서 고른 원하는 스타일로 예) “level-item button is-info is-outlined is-rounded” 으로 변경 하면 되고, 기능도 home으로 변경하려면 기존의 위 코드를 주석 처리하고 아래의 코드를 넣어준다. 아래 코드로 변경하면 profile widget의 followLink가 아닌 홈(“/“) 경로로 static하게 고정된다. themes/icarus/layout/widget/profile.jsx123&lt;div class=\"level\"&gt;&lt;a class=\"level-item button is-info is-outlined is-rounded\" href=\"/\" target=\"_self\" rel=\"noopener\"&gt;Home&lt;/a&gt;&lt;/div&gt; article 가독성을 위해 변경포스팅의 가독성은 hexo Tranquilpeak 테마의 스타일이 좋은것 같았다. 해당 스타일의 css을 참고하여 나의 입맛에 맞추어 수정 하였다. 포스트 제목 폰트 변경 (&amp;.article 밑 .title이 없을텐데 2~5줄 코드를 추가) themes/icarus/include/style/article.styl12345&amp;.article .title font-size: 2.0em font-weight: 700 letter-spacing: -1.4px; 포스트 내용 폰트 변경 (.content 내용을 아래와 같이 수정/추가) themes/icarus/include/style/article.styl123456.content font-size: $article-font-size line-height: 1.9em; letter-spacing: -0.3px; color: #5d686f; margin-top: 20px; heading 폰트 변경 (h1과 h2 수정)heading 간격이 너무 붙어 있어서 조금 벌리고, h1, h2 폰트사이즈도 큰 차이가 없는것 같아서 수정 themes/icarus/include/style/article.styl12345678h1 font-size: 1.95em font-weight: 600 margin-top: 50px;h2 font-size: 1.5em margin-top: 35px; columns 사이즈 변경widescreen일 경우 포스팅내용의 좌우폭을 늘림, bulma의 columns 사이즈를 참고하여 기본 layout 사이즈를 1 높였다. 메뉴얼을 보면 항상 12 columns 를 맞추게 되어있는데 내 블로그의 경우 블로그 내용을 볼때는 위젯을 우측 한줄만 사용함으로 사이즈를 1 높이면, widgets.jsx 을 1 줄여야 할것 같은데 생각보다 위젯이 너무 좁아보여서 그냥 포스팅 내용 폭만 늘렸다. (css를 잘몰라서 사용해보다가 이상한 부분이있으면 다시 조정해야겠다.) 내 블로그는 글을 눌러서 볼때 columnsCount 가 2줄이므로 아래 7번째줄 코드만 is-9-widescreen으로 사이즈 1증가 themes/icarus/layout/layout.jsx123456789101112&lt;div class=\"columns\"&gt; &lt;div class={classname({ column: true, 'order-2': true, 'column-main': true, 'is-12': columnCount === 1, 'is-8-tablet is-8-desktop is-9-widescreen': columnCount === 2, 'is-8-tablet is-8-desktop is-6-widescreen': columnCount === 3 })} dangerouslySetInnerHTML={ __html: body }&gt;&lt;/div&gt; &lt;Widgets site={site} config={config} helper={helper} page={page} position={'left'} /&gt; &lt;Widgets site={site} config={config} helper={helper} page={page} position={'right'} /&gt;&lt;/div&gt; 그 외에도 몇가지그외에도 이것저것 수정을 했는데 다 기억이 나지 않는다..혹시 필요한 부분이 있다면 댓글 부탁드립니다. logo image 크기 늘림 navbar 의 메뉴간 사이 변경 Google Analytics는 계정생성 후 themes/icarus/_config.yml 에 tracking_id 추가시 적용 됨. 포스팅별 읽은 수 및 footer에 나오는 총 방문자는 busuanzi: true 만 적용하니 잘 적용 됨. 덴마크어 yml만 적용되어있어서 처음 변경시 덴마크어로 나오는데, themes/icarus/languages/ko.yml에 plugin: visit:과 visitor: 추가하여 한글추가 등 끝.","link":"/2020/04/18/etc/hexo-blog/"},{"title":"pip(Pypi) 미러서버 설정","text":"데이터분석 공부를 위해 셋팅해둔 docker 이미지(jupyter)를 오랜만에 다시 build 하니 tensorflow 패키지 다운로드가 너무 오래 걸려서 build가 timeout이 되었다.Pypi(pip)의 mirror 설정으로 변경 후 다시 실행하니 바로 해결! mirror 서버 설정은 아래와 같이 ~/.pip/pip.conf을 국내 서버로 설정 ~/.pip/pip.conf123[global]index-url=http://ftp.daumkakao.com/pypi/simpletrusted-host=ftp.daumkakao.com Dockerfile의 경우 아래와 같이 .pip 디렉토리 생성후 동일한 설정 Dockerfile12RUN mkdir ~/.pipRUN printf \"[global]\\nindex-url=http://ftp.daumkakao.com/pypi/simple\\ntrusted-host=ftp.daumkakao.com\" &gt; ~/.pip/pip.conf","link":"/2020/04/19/etc/pip-mirror/"},{"title":"Logstash Java filter plugin 개발","text":"Elastic 공식 Docs의 How to write a Java filter plugin 에 잘 나와있지만,내용대로 진행시 몇가지 에러가 발생했다. FAILURE: Build failed with an exception error: package co.elastic.logstash.api does not exist 으로 검색하여 들어오신 분에게 도움이 되었으면 합니다! intro이때까지 Logstash 를 사용하면서 기본 input, filter, output 플러그인들만 사용했었는데급하게 특정 필드의 암호화/복호화가 필요하여 구글링결과 Java filter plugin 라는 것을 찾았다. 해당 플러그인을 통해 아래와 같이 input 으로 들어온 특정 필드를 내가 만든 Java 코드를 통해 변환시킬 수 있다. Java filter plugin 을 통해 개발한 custom 암복호화 filter123456789101112input { ...}filter { my_decrypt_plugin { source =&gt; \"encrypted_field\" key =&gt; \"password\" }}... 이 문서에서는 Docs의 예제 코드를 plugin으로 만들때 발생하는 에러 해결방법을 설명합니다. Java filter plugin전체적인 방식은 How to write a Java filter plugin 에 잘 나와있지만,해당 내용대로 진행시 (특정 Logstash 버전에서는) 몇가지 에러가 발생한다.. Logstash 다운로드다음 방법 중 환경에 맞게 Logstash 를 다운로드Elastic - Download Logstash Logstash 버전 확인123$ bin/logstash --versionUsing bundled JDK: /usr/share/logstash/jdklogstash 7.11.2 Logstash-core 가 있어야 filter-plugin 빌드 가능Logstash-core compile123456789101112131415# 나에게 맞는 버전의 &lt;branch_name&gt; 으로 다운# git clone --branch &lt;branch_name&gt; --single-branch https://github.com/elastic/logstash.git &lt;target_folder&gt;cd ~/myworkmkdir logstash_corecd logstash_coregit clone --branch 7.11 --single-branch https://github.com/elastic/logstash.git .# 빌드./gradlew assemble# core 빌드 확인ll logstash-core/build/libs/-rw-r--r-- 1 root root 1349807 Feb 26 02:52 logstash-core-7.11.2-javadoc.jar-rw-r--r-- 1 root root 437112 Feb 26 02:52 logstash-core-7.11.2-sources.jar-rw-r--r-- 1 root root 645893 Feb 26 02:52 logstash-core-7.11.2.jar logstash-filter-java 예제코드 다운로드logstash-filter-java1234567cd ~/myworkgit clone https://github.com/logstash-plugins/logstash-filter-java_filter_example# elastic Docs에 있는대로 gradle.properties 만들어서 한줄추가# LOGSTASH_CORE_PATH=/root/mywork/logstash_core/logstash-core/# Docs 의 내용대로 다운받은 Java 코드를 원하는 필터의 형태로 수정해준다. 에러발생이제 이 내용대로 예제코드들을 gem으로 만들려고 ./gradlew gem 하면 에러 발생 첫번째 에러첫번째 에러12345678910FAILURE: Build failed with an exception.** Where:*Build file '/root/mywork/logstash-filter-java_filter_example/build.gradle' line: 102** What went wrong:*A problem occurred configuring root project 'logstash-filter-java_filter_example'.&gt; Could not create task ':gem'.&gt; No signature of method: org.gradle.api.internal.tasks.DefaultTaskDependency$TaskDependencySet.getAt() is applicable for argument types: (ArrayList) values: [[task ':downloadAndInstallJRuby', task ':removeObsoleteJars', ...]]# ... blah-blah 구글링결과 위와 같은 에러는 많은 글이 있었다.출처: https://discuss.elastic.co/t/logstash-java-filter-plugin-example-gradlew-gem-error/257110의 내용대로 build.gradle 을 수정 build.gradle1234dependsOn [downloadAndInstallJRuby, removeObsoleteJars, vendor, generateRubySupportFiles]을dependsOn ([downloadAndInstallJRuby, removeObsoleteJars, vendor, generateRubySupportFiles])으로 수정시 에러 해결 두번째 에러두번째 에러123error: package co.elastic.logstash.api does not existimport co.elastic.logstash.api.Configuration; ^ 패키지를 못찾는 에러 발생여기저기 구글링 중 결국 중국 블로그에서 해결책을 찾았다.출처: https://www.cnblogs.com/shiqi17/p/14168550.html build.gradle1234implementation fileTree(dir: LOGSTASH_CORE_PATH, include: \"**/logstash-core-?.?.?.jar\")을implementation fileTree(dir: LOGSTASH_CORE_PATH, include: \"**/logstash-core-?.??.?.jar\")으로 수정시 에러 해결 원인은 내가 받은 Logstash의 마이너 버전이 7.11.2 으로 두자리 숫자라 제대로 맵핑이 안되서 발생된 것이었다.Logstash 의 버전을 확인하여 마이너 버전이 두자리일 경우에만 build.gradle 의 위 코드 ?.?.? 을 ?.??.? 으로 수정 하면 됩니다. gem 으로 빌드된 custom plugin을 Logstash에 설치Java filter plugin install1234$ bin/logstash-plugin install --no-verify --local /root/mywork/logstash-filter-java_filter_example/logstash-filter-java_filter_example-1.0.2.gem...Installing logstash-filter-java_filter_exampleInstallation successful 설치한 플러그인 실행example plugin test123456789101112131415161718192021$ cat java_filter.confinput { generator { message =&gt; \"Hello world!\" count =&gt; 1 }}filter { java_filter_example {}}output { stdout { codec =&gt; rubydebug }}$ bin/logstash -f ./java_filter.conf{ \"message\" =&gt; \"!dlrow olleH\", \"@version\" =&gt; \"1\", \"@timestamp\" =&gt; 2021-02-26T04:05:27.633Z, \"host\" =&gt; \"host\", \"sequence\" =&gt; 0}","link":"/2021/03/11/data/elastic/logstash-java-filter-plugin/"}],"tags":[{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"pip","slug":"pip","link":"/tags/pip/"},{"name":"docker","slug":"docker","link":"/tags/docker/"},{"name":"elastic","slug":"elastic","link":"/tags/elastic/"},{"name":"logstash","slug":"logstash","link":"/tags/logstash/"}],"categories":[{"name":"others","slug":"others","link":"/categories/others/"},{"name":"data","slug":"data","link":"/categories/data/"},{"name":"elastic","slug":"data/elastic","link":"/categories/data/elastic/"}]}